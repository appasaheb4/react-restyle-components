"use strict";import{jsx as f,jsxs as g}from"react/jsx-runtime";import U,{useState as M,useEffect as C,useRef as O}from"react";import{Textarea as V}from"../../../core-components/atoms/Textarea/Textarea";import{Icon as R}from"../../Icon/Icon";import t from"../../../tc.module.css";import{cn as u}from"../../../utils";import{properties as I}from"../css-properties";const N=v=>{const p=[];return v.forEach(function(d,j){const a=Object.keys(d)[0],l=a;p.push([l,d[a]])}),p};export const CssMultilineInput=U.forwardRef(({id:v,label:p,error:d,required:j,value:a,onChange:l,onBlur:o,disabled:z,cssProperties:m,onReset:y,onMoreInfo:w,placeholder:E="fontSize: 12,backgroundColor:'#000000'",className:W,labelProps:A,...T},_)=>{const[k,S]=M(!1),[L,h]=M(m||N(I)),r=O(a||""),b=O(null);C(()=>{h(m||N(I))},[m]),C(()=>{a!==void 0&&(r.current=a)},[a]),C(()=>{function e(n){b.current&&!b.current.contains(n.target)&&k&&S(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[k]);const $=e=>{const n=m||N(I);if(e.length===0){h(n);return}const c=e.split(/,\s*/),s=c[c.length-1].split(":")[0]?.split("'")[0]?.trim(),x=n.filter(P=>P[0]?.startsWith(s||""));h(x)},q=e=>{r.current=e,$(e)},F=e=>{const n=e.target.value;if(q(n),S(!0),l)try{const i=l.toString().match(/\(([^)]+)\)/);if(i){const s=i[1].trim();s&&s!=="e"&&s!=="event"&&!s.startsWith("e:")?l(n):l(e)}else l(e)}catch{try{l(e)}catch{l(n)}}},H=e=>{if(o){const n=e.target.value;try{const i=o.toString().match(/\(([^)]+)\)/);if(i){const s=i[1].trim();s&&s!=="e"&&s!=="event"&&!s.startsWith("e:")?o(n):o(e)}else o(e)}catch{try{o(e)}catch{o(n)}}}},K=()=>{const e=r.current.split(",").filter(Boolean);e.length>0?(e.pop(),r.current=e.join(",")+(e.length?",":"")):r.current="",y&&y(r.current),l&&l(r.current)};return g("div",{className:u(t.flex,t["flex-col"],t["w-full"],t.relative,W),ref:b,children:[g("div",{className:u(t.flex,t.absolute,t["gap-2"],t["right-2"],t["z-10"]),children:[y&&f(R,{nameIcon:"MdLockReset",propsIcon:{color:"#000000",size:24},onClick:K}),w&&f(R,{nameIcon:"MdInfoOutline",propsIcon:{color:"#000000",size:24},onClick:w})]}),f(V,{ref:_,id:v,label:p,error:d,required:j,placeholder:E,value:r.current,onChange:F,onBlur:H,onKeyUp:()=>S(!0),disabled:z,...A,...T}),k&&L.length>0&&f("div",{children:f("ul",{className:u(t.flex,t["flex-col"],t["bg-black"],t["text-white"],t["overflow-y-scroll"],t["w-full"]),style:{maxHeight:"calc(100vh - 20vh)"},children:L?.map((e,n)=>g("li",{className:u(t.flex,t["gap-4"],t["p-2"]),children:[f("span",{className:u(t.underline),children:e[0]}),e[1]?.map((c,i)=>g("li",{className:u(t.flex,t["bg-slate-800"],t["rounded-md"],t["items-center"],t["cursor-pointer"]),onClick:()=>{let s=r.current?.split(",");r.current.includes(",")?(s=s.map(x=>{if(x?.includes(":"))return x}),c!="number"?s.push(`${e[0]}:'${c}',`):s.push(`${e[0]}:1,`),r.current=s.join(",").replaceAll(",,",",")):c!="number"?r.current=`${e[0]}:'${c}',`:r.current=`${e[0]}:1,`,$(s.join(""))},children:[" ",c," "]},i))]},n))})}),d&&f("p",{className:u(t["mt-1"],t["text-sm"],t["text-red-600"],t["dark:text-red-400"]),children:d})]})});CssMultilineInput.displayName="CssMultilineInput";
