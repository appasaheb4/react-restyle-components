"use strict";"use client";import{jsx as t,jsxs as i,Fragment as ie}from"react/jsx-runtime";import oe,{forwardRef as Gl,useImperativeHandle as zl,useMemo as z,useCallback as p,useState as V,useEffect as Ie,useRef as ln}from"react";import{GridRoot as Vl,GridWrapper as Hl,GridToolbar as Wl,ToolbarGroup as rn,ToolbarButton as ae,QuickFilter as Nl,TableContainer as jl,StyledTable as Ol,TableHead as ql,HeaderRow as Kl,HeaderCell as Pe,HeaderCellContent as Ql,HeaderText as Xl,SortIndicator as _l,FilterIndicator as Ul,ResizeHandle as Yl,GroupHeaderRow as Zl,GroupHeaderCell as on,FloatingFilterRow as Jl,FloatingFilterCell as Re,TableBody as er,TableRow as an,TableCell as H,CellContent as sn,Checkbox as De,CheckboxCell as dn,ExpandButton as tr,DragHandle as nr,CellEditor as lr,PaginationBar as rr,PaginationInfo as ir,PaginationControls as or,PageButton as Le,PageSizeSelect as ar,StatusBar as sr,StatusItem as cn,LoadingOverlay as hn,Spinner as dr,NoRowsOverlay as un,ContextMenu as cr,ContextMenuItem as rt,ContextMenuDivider as hr,MobileCardContainer as gn,MobileCard as pn,MobileCardHeader as ur,MobileCardRow as gr,MobileCardLabel as pr,MobileCardValue as mr,SelectionBar as Cr,SelectionActions as fr,getTheme as $r,SidePanel as kr,SidePanelTabs as vr,SidePanelTab as Fe,SidePanelContent as Sr,SidePanelSearch as mn,SidePanelSection as it,SidePanelSectionHeader as ot,SidePanelColumnItem as xr,SidePanelDragHandle as Cn,SidePanelGroupLabel as yr,RowGroupsZone as at,RowGroupsLabel as st,RowGroupChip as fn,ValuesPanel as br,ValueItem as wr,ValueItemLabel as Mr,ValueItemRemove as Ir,PivotModeToggle as Pr,PivotModeLabel as Rr,ToggleSwitch as Dr,HeaderMenuButton as Lr,ColumnMenuPopup as Fr,ColumnMenuSection as se,ColumnMenuItem as M,SetFilterContainer as Er,SetFilterHeader as Tr,SetFilterSearch as Ar,SetFilterList as $n,SetFilterItem as de,SetFilterActions as Br,SetFilterButton as kn,FilterPanelColumn as Gr,FilterPanelHeader as zr,FilterPanelContent as Vr,GridLayout as Hr,GridMainArea as Wr}from"./elements";import{useSorting as Nr,useFiltering as jr,usePagination as Or,useRowSelection as qr,useRowExpansion as Kr,useColumnState as Qr,useCellEditing as Xr,useContextMenu as _r,useResponsive as Ur,useClipboard as Yr,getNestedValue as D,createRowNode as x,exportToCsv as dt,useAggregationPanel as Zr,useRowGroupingPanel as Jr,useColumnMenu as ei,useSidePanel as ti,usePivotMode as ni}from"./hooks";const li=()=>i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t("circle",{cx:"11",cy:"11",r:"8"}),t("path",{d:"M21 21l-4.35-4.35",strokeLinecap:"round"})]}),vn=()=>t("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t("path",{d:"M7 14l5-5 5 5H7z"})}),Sn=()=>t("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t("path",{d:"M7 10l5 5 5-5H7z"})}),Ee=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("path",{d:"M22 3H2l8 9.46V19l4 2v-8.54L22 3z",strokeLinecap:"round",strokeLinejoin:"round"})}),ct=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("path",{d:"M9 18l6-6-6-6",strokeLinecap:"round",strokeLinejoin:"round"})}),ri=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("path",{d:"M15 18l-6-6 6-6",strokeLinecap:"round",strokeLinejoin:"round"})}),ii=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("path",{d:"M11 17l-5-5 5-5M18 17l-5-5 5-5",strokeLinecap:"round",strokeLinejoin:"round"})}),oi=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("path",{d:"M13 7l5 5-5 5M6 7l5 5-5 5",strokeLinecap:"round",strokeLinejoin:"round"})}),ai=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3",strokeLinecap:"round",strokeLinejoin:"round"})}),Te=()=>i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t("rect",{x:"3",y:"3",width:"7",height:"18",rx:"1"}),t("rect",{x:"14",y:"3",width:"7",height:"18",rx:"1"})]}),si=()=>i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t("path",{d:"M23 4v6h-6M1 20v-6h6",strokeLinecap:"round",strokeLinejoin:"round"}),t("path",{d:"M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15",strokeLinecap:"round",strokeLinejoin:"round"})]}),di=()=>i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t("circle",{cx:"12",cy:"12",r:"1"}),t("circle",{cx:"12",cy:"5",r:"1"}),t("circle",{cx:"12",cy:"19",r:"1"})]}),ht=()=>i("svg",{viewBox:"0 0 24 24",fill:"currentColor",opacity:"0.5",children:[t("circle",{cx:"9",cy:"5",r:"1.5"}),t("circle",{cx:"9",cy:"12",r:"1.5"}),t("circle",{cx:"9",cy:"19",r:"1.5"}),t("circle",{cx:"15",cy:"5",r:"1.5"}),t("circle",{cx:"15",cy:"12",r:"1.5"}),t("circle",{cx:"15",cy:"19",r:"1.5"})]}),ci=()=>i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),t("path",{d:"M3 9h18M9 3v18",strokeLinecap:"round"})]}),ce=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("path",{d:"M18 6L6 18M6 6l12 12",strokeLinecap:"round",strokeLinejoin:"round"})}),hi=()=>i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t("path",{d:"M12 2v10M12 22v-6M4 12h16",strokeLinecap:"round"}),t("circle",{cx:"12",cy:"12",r:"3"})]}),ui=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("path",{d:"M4 4v16M8 12h12M15 7l5 5-5 5",strokeLinecap:"round",strokeLinejoin:"round"})}),gi=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("path",{d:"M20 4v16M4 12h12M9 7l-5 5 5 5",strokeLinecap:"round",strokeLinejoin:"round"})}),pi=()=>i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t("path",{d:"M3 3l18 18M12 2v10M12 22v-6",strokeLinecap:"round"}),t("circle",{cx:"12",cy:"12",r:"3"})]}),Ae=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("path",{d:"M4 6h16M4 12h16M4 18h16",strokeLinecap:"round"})}),xn=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("path",{d:"M4 12h16M9 7l-5 5 5 5M15 7l5 5-5 5",strokeLinecap:"round",strokeLinejoin:"round"})}),mi=()=>i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t("path",{d:"M3 12a9 9 0 109-9 9.75 9.75 0 00-6.74 2.74L3 8",strokeLinecap:"round",strokeLinejoin:"round"}),t("path",{d:"M3 3v5h5",strokeLinecap:"round",strokeLinejoin:"round"})]}),yn=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("path",{d:"M18 6H6l6 6-6 6h12",strokeLinecap:"round",strokeLinejoin:"round"})}),Ai=()=>i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),t("circle",{cx:"12",cy:"12",r:"3"})]}),Bi=()=>i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),t("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),Gi=()=>t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t("polyline",{points:"20 6 9 17 4 12",strokeLinecap:"round",strokeLinejoin:"round"})}),Ci=()=>i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),t("path",{d:"M15 3v18",strokeLinecap:"round"})]});function ut(R){return"children"in R}function Be(R){const Q=[];return R.forEach(b=>{ut(b)?Q.push(...Be(b.children)):Q.push(b)}),Q}function fi(R,Q){const{rowData:b,columnDefs:he,defaultColDef:gt,getRowId:k=e=>String(e.data._id??e.data.id??Math.random()),theme:pt="quartz",customTheme:mt,rowHeight:bn=42,headerHeight:wn=42,floatingFiltersHeight:Mn=32,domLayout:In="normal",rowSelection:L,rowMultiSelectWithClick:$i=!1,suppressRowClickSelection:Ct=!1,isRowSelectable:Pn,sortable:ue=!0,suppressMultiSort:Rn=!1,alwaysMultiSort:Ge=!1,filter:ki=!0,floatingFilter:Dn=!1,quickFilterText:ze,pagination:Ve=!1,paginationPageSize:Ln=10,paginationPageSizeSelector:ft=[10,25,50,100],suppressPaginationPanel:Fn=!1,singleClickEdit:ge=!1,stopEditingWhenCellsLoseFocus:En=!0,undoRedoCellEditing:vi=!1,groupDefaultExpanded:Tn=0,masterDetail:X=!1,detailCellRenderer:$t,isRowMaster:An,rowDragManaged:pe=!1,loadingOverlayComponent:kt,noRowsOverlayComponent:vt,statusBar:Bn,enableClipboard:St=!0,suppressCsvExport:Gn=!1,getContextMenuItems:zn,suppressContextMenu:xt=!1,enableBrowserTooltips:Vn=!1,responsive:yt=!0,mobileBreakpoint:Hn=768,mobileCardRenderer:bt,animateRows:Wn=!0,enableRtl:Nn=!1,onGridReady:jn,onCellClicked:wt,onCellDoubleClicked:Mt,onCellValueChanged:It,onRowClicked:Pt,onRowDoubleClicked:Si,onRowSelected:Rt,onSelectionChanged:Dt,onSortChanged:Lt,onFilterChanged:Ft,onPaginationChanged:On,containerStyle:qn,containerClassName:Kn,context:c,gridId:Qn}=R,l=z(()=>$r(pt,mt),[pt,mt]),_=z(()=>Be(he).map(n=>({...gt,...n,colId:n.colId||n.field||`col-${Math.random()}`})),[he,gt]),{columnState:T,processedColumns:me,visibleColumns:g,setColumnVisible:Ce,setColumnWidth:U,setColumnPinned:W,moveColumn:Y,resetColumnState:fe}=Qr(_,Qn),{sortModel:Et,handleSort:$e,getSortForColumn:ke,clearSort:xi,sortData:Tt}=Nr([],!Rn||Ge),{filterModel:At,quickFilterText:He,setQuickFilterText:Z,setColumnFilter:Xn,clearFilters:Bt,isFilterActive:Gt,hasActiveFilters:We,filterData:zt}=jr();Ie(()=>{ze!==void 0&&Z(ze)},[ze,Z]);const[F,Ne]=V({}),y=z(()=>{let e=[...b];return e=zt(e,g),Object.entries(F).forEach(([n,r])=>{const o=new Set;b.forEach(s=>{const a=D(s,n);a!=null&&o.add(String(a))}),r.size>0&&r.size<o.size?e=e.filter(s=>{const a=D(s,n);return a==null?!1:r.has(String(a))}):r.size===0&&(e=[])}),e=Tt(e,g),e},[b,zt,Tt,g,F]),{currentPage:A,pageSize:je,totalPages:J,startRow:ve,endRow:Oe,goToPage:Vt,goToNextPage:qe,goToPreviousPage:Ke,goToFirstPage:Qe,goToLastPage:Xe,changePageSize:_e,paginateData:Ht}=Or(y.length,Ln),m=z(()=>Ve?Ht(y):y,[y,Ve,Ht]),{selectedIds:yi,isSelected:Se,toggleRow:xe,selectAll:ye,deselectAll:ee,isAllSelected:_n,isIndeterminate:Un,selectedRows:C}=qr(m,e=>k({data:e}),L||"multiple",Pn),{isExpanded:Yn,toggleExpand:Zn,expandAll:Wt,collapseAll:Nt}=Kr(e=>k({data:e}),Tn),{editingCell:I,startEditing:N,stopEditing:B,isEditing:Jn}=Xr(),[te,j]=V(null),{contextMenu:w,showContextMenu:jt,hideContextMenu:bi}=_r(),{copyToClipboard:O}=Yr(),{isMobile:el}=Ur(Hn),{isOpen:ne,activeTab:q,toggle:tl,switchTab:le,setIsOpen:Ue}=ti(R.sideBar!==!1,"columns"),{menuState:v,showColumnMenu:nl,hideColumnMenu:S,filterDropdownState:G,showFilterDropdown:ll,hideFilterDropdown:Ye}=ei(),{rowGroupColumns:Ze,addRowGroupColumn:rl,removeRowGroupColumn:Ot,clearRowGroupColumns:wi,groupableColumns:Mi,groupedColumnsInfo:qt}=Jr(_),{valueColumns:Kt,addValueColumn:Ii,removeValueColumn:il,clearValueColumns:Pi,aggregatedValues:Ri}=Zr(y),{isPivotMode:ol,togglePivotMode:al}=ni(),[sl,dl]=V(new Set),[E,Je]=V(null),[cl,be]=V(null),hl=p((e,n)=>{Je(n),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",n)},[]),ul=p((e,n)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",n!==E&&be(n)},[E]),gl=p(()=>{be(null)},[]),pl=p((e,n)=>{if(e.preventDefault(),E&&E!==n){const r=T.findIndex(s=>s.colId===E),o=T.findIndex(s=>s.colId===n);r!==-1&&o!==-1&&Y(E,o)}Je(null),be(null)},[E,T,Y]),ml=p(()=>{Je(null),be(null)},[]),P=p(e=>{const n=new Set;return b.forEach(r=>{const o=D(r,e);o!=null&&n.add(String(o))}),Array.from(n).sort()},[b]),Cl=p(e=>{dl(n=>{const r=new Set(n);return r.has(e)?r.delete(e):r.add(e),r})},[]),Qt=p((e,n)=>{Ne(r=>{const o=r[e]||new Set(P(e)),s=new Set(o);return s.has(n)?s.delete(n):s.add(n),{...r,[e]:s}})},[P]),et=p(e=>{Ne(n=>{const r=P(e),o=n[e];return!o||o.size===r.length?{...n,[e]:new Set}:{...n,[e]:new Set(r)}})},[P]),Xt=p(e=>{const n=F[e];if(!n)return!1;const r=P(e);return n.size>0&&n.size<r.length},[F,P]),fl=z(()=>Object.entries(F).some(([e,n])=>{const r=P(e);return n.size>0&&n.size<r.length}),[F,P]),_t=p(()=>{Ne({})},[]),$l=p(()=>{Bt(),_t()},[Bt,_t]),we=ln(null),kl=ln(null),[Ut,Yt]=V(!1),[K,Zt]=V(null),vl=p((e,n,r)=>{e.preventDefault(),Zt({colId:n,startX:e.clientX,startWidth:r})},[]);Ie(()=>{if(!K)return;const e=r=>{const o=r.clientX-K.startX,s=Math.max(50,K.startWidth+o);U(K.colId,s)},n=()=>{Zt(null)};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",n),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n)}},[K,U]);const h=z(()=>({setRowData:()=>{},getRowData:()=>b,applyTransaction:()=>{},applyTransactionAsync:()=>{},refreshCells:()=>{},redrawRows:()=>{},getRowNode:e=>m.find(n=>k({data:n})===e),forEachNode:e=>m.forEach((n,r)=>e(x(n,r),r)),forEachLeafNode:e=>m.forEach((n,r)=>e(x(n,r),r)),getDisplayedRowCount:()=>m.length,getDisplayedRowAtIndex:e=>x(m[e],e),getFirstDisplayedRow:()=>ve,getLastDisplayedRow:()=>Oe,selectAll:ye,deselectAll:ee,selectAllFiltered:ye,deselectAllFiltered:ee,getSelectedRows:()=>C,getSelectedNodes:()=>C.map((e,n)=>x(e,n)),getSortModel:()=>Et,setSortModel:()=>{},setFilterModel:()=>{},getFilterModel:()=>At,setQuickFilter:Z,isQuickFilterPresent:()=>He.length>0,isAnyFilterPresent:()=>We,destroyFilter:()=>{},getFilterInstance:()=>null,onFilterChanged:()=>{},paginationGetPageSize:()=>je,paginationSetPageSize:_e,paginationGetCurrentPage:()=>A,paginationGetTotalPages:()=>J,paginationGetRowCount:()=>y.length,paginationGoToPage:Vt,paginationGoToNextPage:qe,paginationGoToPreviousPage:Ke,paginationGoToFirstPage:Qe,paginationGoToLastPage:Xe,startEditingCell:({rowIndex:e,colKey:n})=>{const r=m[e];if(r){const o=D(r,n);N(k({data:r}),n,e,o)}},stopEditing:e=>B(e||!1),getEditingCells:()=>I?[{rowIndex:I.rowIndex,column:{}}]:[],exportDataAsCsv:e=>{dt(C.length>0&&e?.onlySelected?C:y,g,e?.fileName||"export.csv")},getDataAsCsv:()=>"",exportDataAsExcel:()=>{},copySelectedRangeToClipboard:e=>O(C,g,e),copySelectedRowsToClipboard:e=>O(C,g,e),pasteFromClipboard:()=>{},ensureIndexVisible:()=>{},ensureNodeVisible:()=>{},ensureColumnVisible:()=>{},getHorizontalScrollPosition:()=>we.current?.scrollLeft||0,getVerticalScrollPosition:()=>we.current?.scrollTop||0,resetRowHeights:()=>{},onRowHeightChanged:()=>{},sizeColumnsToFit:()=>{},autoSizeAllColumns:()=>{},autoSizeColumn:()=>{},expandAll:()=>Wt(m),collapseAll:Nt,setRowGroupColumns:()=>{},getRowGroupColumns:()=>[],addEventListener:()=>{},removeEventListener:()=>{},destroy:()=>{},getContext:()=>c,setContext:()=>{},isDestroyed:()=>!1,refreshHeader:()=>{},setHeaderHeight:()=>{},showLoadingOverlay:()=>Yt(!0),showNoRowsOverlay:()=>{},hideOverlay:()=>Yt(!1),getGridElement:()=>we.current}),[b,m,k,ve,Oe,ye,ee,C,Et,At,Z,He,We,je,_e,A,J,y,Vt,qe,Ke,Qe,Xe,N,B,I,g,O,Wt,Nt,c]),u=z(()=>({getAllColumns:()=>me.map((e,n)=>({...e,colId:e.colId,colDef:e,sort:null,visible:!e.hide,pinned:e.pinned||null,width:e.width||100,left:0,getColDef:()=>e,getColId:()=>e.colId,isVisible:()=>!e.hide,isPinned:()=>!!e.pinned,getSort:()=>ke(e.colId).sort,setSort:()=>{}})),getAllGridColumns:()=>[],getVisibleColumns:()=>g.map(e=>({colId:e.colId,colDef:e})),getColumn:e=>me.find(n=>n.colId===e),setColumnVisible:Ce,setColumnsVisible:(e,n)=>e.forEach(r=>Ce(String(r),n)),setColumnPinned:W,setColumnsPinned:(e,n)=>e.forEach(r=>W(String(r),n)),moveColumn:Y,moveColumns:(e,n)=>e.forEach((r,o)=>Y(String(r),n+o)),getColumnState:()=>T,applyColumnState:()=>!0,resetColumnState:fe,setColumnWidth:U,setColumnsWidth:(e,n)=>e.forEach(r=>U(String(r),n)),autoSizeColumn:()=>{},autoSizeColumns:()=>{},sizeColumnsToFit:()=>{},isPinningLeft:()=>g.some(e=>e.pinned==="left"),isPinningRight:()=>g.some(e=>e.pinned==="right"),getDisplayNameForColumn:e=>e.colDef.headerName||e.colDef.field||""}),[me,g,T,Ce,W,Y,fe,U,ke]);zl(Q,()=>({api:h,columnApi:u}),[h,u]),Ie(()=>{jn?.({type:"gridReady",api:h,columnApi:u,context:c})},[]);const Jt=p((e,n,r,o,s)=>{const a=o.field?D(n,o.field):null,d=x(n,r);wt?.({type:"cellClicked",api:h,columnApi:u,context:c,data:n,node:d,column:{colId:o.colId,colDef:o},colDef:o,value:a,rowIndex:r,event:e.nativeEvent}),ge&&o.editable&&(N(k({data:n}),o.colId,r,a),j(a)),L&&!Ct&&!o.checkboxSelection&&(xe(n,r),Rt?.({type:"rowSelected",api:h,columnApi:u,context:c,data:n,node:d,rowIndex:r}))},[h,u,c,wt,ge,L,Ct,xe,Rt,N,k]),en=p((e,n,r,o,s)=>{const a=o.field?D(n,o.field):null,d=x(n,r);Mt?.({type:"cellDoubleClicked",api:h,columnApi:u,context:c,data:n,node:d,column:{colId:o.colId,colDef:o},colDef:o,value:a,rowIndex:r,event:e.nativeEvent}),!ge&&o.editable&&(N(k({data:n}),o.colId,r,a),j(a))},[h,u,c,Mt,ge,N,k]),tt=p((e,n,r)=>{const o=x(n,r);Pt?.({type:"rowClicked",api:h,columnApi:u,context:c,data:n,node:o,rowIndex:r,event:e.nativeEvent})},[h,u,c,Pt]),Sl=p((e,n)=>{e.sortable!==!1&&ue&&($e(e.colId,n.shiftKey||Ge),Lt?.({type:"sortChanged",api:h,columnApi:u,context:c}))},[ue,$e,Ge,Lt,h,u,c]),tn=p((e,n,r,o)=>{xt||(e.preventDefault(),jt(e.clientX,e.clientY,{row:n,rowIndex:r,col:o}))},[xt,jt]),Me=p(e=>{I&&It?.({type:"cellValueChanged",api:h,columnApi:u,context:c,data:{},node:x({},I.rowIndex),column:{},colDef:{},oldValue:I.value,newValue:e,rowIndex:I.rowIndex}),B(!1,e),j(null)},[I,It,h,u,c,B]),xl=p(e=>{I&&(e.key==="Escape"?(B(!0),j(null)):e.key==="Enter"&&Me(te)),St&&(e.ctrlKey||e.metaKey)&&e.key==="c"&&O(C,g,!0)},[I,B,Me,te,St,O,C,g]),yl=he.some(ut),bl=()=>yl?t(Zl,{$theme:l,children:he.map((e,n)=>ut(e)?t(on,{$theme:l,$colSpan:Be(e.children).length,colSpan:Be(e.children).length,children:e.headerName},e.groupId||n):t(on,{$theme:l,$colSpan:1},e.field||n))}):null,wl=()=>i(Kl,{$theme:l,$height:wn,children:[L&&t(Pe,{$theme:l,$width:40,$align:"center",children:t(dn,{children:t(De,{type:"checkbox",$theme:l,checked:_n,ref:e=>e&&(e.indeterminate=Un),onChange:e=>{e.target.checked?ye():ee(),Dt?.({type:"selectionChanged",api:h,columnApi:u,context:c})}})})}),pe&&t(Pe,{$theme:l,$width:40,$align:"center"}),X&&t(Pe,{$theme:l,$width:40,$align:"center"}),g.map((e,n)=>{const r=e.colId,{sort:o}=ke(r),a=T.find(d=>d.colId===r)?.width||e.width;return i(Pe,{$theme:l,$align:e.headerAlign||e.align,$sortable:e.sortable!==!1&&ue,$sorted:!!o,$resizable:e.resizable!==!1,$pinned:e.pinned,$width:a,$minWidth:e.minWidth,$maxWidth:e.maxWidth,onClick:d=>Sl(e,d),onMouseEnter:d=>{const f=d.currentTarget.querySelector("[data-menu-button]");f&&(f.style.opacity="1")},onMouseLeave:d=>{const f=d.currentTarget.querySelector("[data-menu-button]");f&&v.colId!==r&&(f.style.opacity="0")},children:[i(Ql,{children:[t(Xl,{children:e.headerName||e.field}),e.sortable!==!1&&ue&&t(_l,{$direction:o,$active:!!o,children:o==="desc"?t(Sn,{}):t(vn,{})}),e.filter&&t(Ul,{$active:Gt(e.field||"")||Xt(e.field||""),$theme:l,onClick:d=>{d.stopPropagation();const f=d.target.getBoundingClientRect();ll(r,f.left,f.bottom+4)},children:t(Ee,{})}),!e.suppressMenu&&t(Lr,{"data-menu-button":!0,$theme:l,$active:v.visible&&v.colId===r,onClick:d=>{d.stopPropagation();const f=d.target.getBoundingClientRect();v.visible&&v.colId===r?S():nl(r,f.left,f.bottom+4)},children:t(di,{})})]}),e.resizable!==!1&&t(Yl,{$theme:l,$resizing:K?.colId===r,onMouseDown:d=>vl(d,r,a||100)})]},r)})]}),Ml=()=>Dn?i(Jl,{$theme:l,$height:Mn,children:[L&&t(Re,{$theme:l}),pe&&t(Re,{$theme:l}),X&&t(Re,{$theme:l}),g.map(e=>t(Re,{$theme:l,children:e.filter&&t("input",{type:"text",placeholder:`Filter ${e.headerName||e.field}...`,onChange:n=>{Xn(e.field||"",{filterType:"text",filter:n.target.value}),Ft?.({type:"filterChanged",api:h,columnApi:u,context:c})}})},e.colId))]}):null,Il=(e,n,r,o)=>{const s=r.colId,a=k({data:e}),d=r.field?D(e,r.field):null,f=Jn(a,s),nt=T.find($=>$.colId===s)?.width||r.width;if(f)return t(H,{$theme:l,$editing:!0,$align:r.align,$width:nt,children:t(lr,{$theme:l,children:t("input",{type:r.cellEditor==="agNumberCellEditor"?"number":"text",value:te??"",onChange:$=>j($.target.value),onBlur:()=>En&&Me(te),onKeyDown:$=>{$.key==="Enter"&&Me(te),$.key==="Escape"&&(B(!0),j(null))},autoFocus:!0})})},s);if(r.cellRenderer){const $=r.cellRenderer,Bl={value:d,data:e,node:x(e,n,a),rowIndex:n,colDef:r,column:{colId:s,colDef:r},api:h,columnApi:u,context:c,refreshCell:()=>{},eGridCell:null,getValue:()=>d,setValue:()=>{}};return t(H,{$theme:l,$align:r.align,$pinned:r.pinned,$width:nt,onClick:re=>Jt(re,e,n,r,o),onDoubleClick:re=>en(re,e,n,r,o),onContextMenu:re=>tn(re,e,n,r),children:t(sn,{$wrapText:r.wrapText,children:t($,{...Bl})})},s)}let lt=d;return r.valueFormatter&&(lt=r.valueFormatter({value:d,data:e,node:x(e,n,a),colDef:r,column:{colId:s,colDef:r},api:h,columnApi:u,context:c})),t(H,{$theme:l,$align:r.align,$pinned:r.pinned,$width:nt,title:Vn?String(lt??""):void 0,onClick:$=>Jt($,e,n,r,o),onDoubleClick:$=>en($,e,n,r,o),onContextMenu:$=>tn($,e,n,r),children:t(sn,{$wrapText:r.wrapText,children:lt??""})},s)},Pl=(e,n)=>{const r=k({data:e}),o=Se(r),s=Yn(r),a=X&&(An?.(e)??!0);return i(oe.Fragment,{children:[i(an,{$theme:l,$selected:o,$striped:!0,$even:n%2===0,$height:bn,$animate:Wn,onClick:d=>tt(d,e,n),children:[L&&t(H,{$theme:l,$align:"center",$width:40,children:t(dn,{children:t(De,{type:"checkbox",$theme:l,checked:o,onChange:()=>{xe(e,n),Dt?.({type:"selectionChanged",api:h,columnApi:u,context:c})},onClick:d=>d.stopPropagation()})})}),pe&&t(H,{$theme:l,$align:"center",$width:40,children:t(nr,{$theme:l,children:t(ht,{})})}),X&&t(H,{$theme:l,$align:"center",$width:40,children:a&&t(tr,{$theme:l,$expanded:s,onClick:d=>{d.stopPropagation(),Zn(e)},children:t(ct,{})})}),g.map((d,f)=>Il(e,n,d,f))]}),X&&a&&s&&$t&&t(an,{$theme:l,children:t(H,{$theme:l,colSpan:g.length+(L?1:0)+(pe?1:0)+1,style:{padding:"16px"},children:oe.createElement($t,{value:null,data:e,node:x(e,n,r),rowIndex:n,colDef:{},column:{},api:h,columnApi:u,context:c,refreshCell:()=>{},eGridCell:null,getValue:()=>null,setValue:()=>{}})})})]},r)},Rl=()=>bt?t(gn,{$theme:l,children:m.map((e,n)=>{const r=k({data:e});return t(pn,{$theme:l,$selected:Se(r),onClick:o=>tt(o,e,n),children:oe.createElement(bt,{data:e,node:x(e,n,r)})},r)})}):t(gn,{$theme:l,children:m.map((e,n)=>{const r=k({data:e});return i(pn,{$theme:l,$selected:Se(r),onClick:o=>tt(o,e,n),children:[L&&t(ur,{$theme:l,children:t(De,{type:"checkbox",$theme:l,checked:Se(r),onChange:()=>xe(e,n)})}),g.slice(0,6).map(o=>{const s=o.field?D(e,o.field):null;return i(gr,{$theme:l,children:[t(pr,{$theme:l,children:o.headerName||o.field}),t(mr,{$theme:l,children:String(s??"")})]},o.colId)})]},r)})}),nn=()=>vt?t(un,{$theme:l,children:oe.createElement(vt,{})}):i(un,{$theme:l,children:[t(ci,{}),t("span",{children:"No Rows To Show"})]}),Dl=()=>kt?t(hn,{$theme:l,children:oe.createElement(kt,{})}):i(hn,{$theme:l,children:[t(dr,{$theme:l}),t("span",{children:"Loading..."})]}),Ll=()=>!Ve||Fn?null:i(rr,{$theme:l,children:[i(ir,{$theme:l,children:["Showing ",ve+1," to ",Oe," of ",y.length," rows"]}),i(or,{children:[t(Le,{$theme:l,onClick:Qe,disabled:A===0,children:t(ii,{})}),t(Le,{$theme:l,onClick:Ke,disabled:A===0,children:t(ri,{})}),i("span",{style:{padding:"0 12px",fontSize:"13px"},children:["Page ",A+1," of ",J]}),t(Le,{$theme:l,onClick:qe,disabled:A>=J-1,children:t(ct,{})}),t(Le,{$theme:l,onClick:Xe,disabled:A>=J-1,children:t(oi,{})}),Array.isArray(ft)&&t(ar,{$theme:l,value:je,onChange:e=>{_e(Number(e.target.value)),On?.({type:"paginationChanged",api:h,columnApi:u,context:c,newPage:!1,newPageSize:!0,animate:!0,keepRenderedRows:!1})},children:ft.map(e=>i("option",{value:e,children:[e," rows"]},e))})]})]}),Fl=()=>{if(!w.visible)return null;const e=zn?.({node:w.data?.row?x(w.data.row,w.data.rowIndex):{},column:{colId:w.data?.col?.colId,colDef:w.data?.col},value:w.data?.col?.field?D(w.data.row,w.data.col.field):null})||["copy","separator","export"];return t(cr,{$theme:l,$x:w.x,$y:w.y,children:e.map((n,r)=>{if(n==="separator")return t(hr,{$theme:l},r);if(typeof n=="string")switch(n){case"copy":return i(rt,{$theme:l,onClick:()=>O(C,g,!0),children:["Copy",t("span",{className:"shortcut",children:"Ctrl+C"})]},n);case"export":return t(rt,{$theme:l,onClick:()=>dt(y,g,"export.csv"),children:"Export to CSV"},n);default:return null}return i(rt,{$theme:l,$disabled:n.disabled,$danger:n.cssClasses?.includes("danger"),onClick:()=>!n.disabled&&n.action?.(),children:[n.icon,n.name,n.shortcut&&t("span",{className:"shortcut",children:n.shortcut})]},n.name)})})},El=()=>{if(!v.visible||!v.colId)return null;const e=_.find(o=>o.colId===v.colId);if(!e)return null;const n=v.colId,{sort:r}=ke(n);return i(Fr,{$theme:l,$x:v.x,$y:v.y,onClick:o=>o.stopPropagation(),children:[i(se,{$theme:l,children:[i(M,{$theme:l,onClick:()=>{$e(n,!1),S()},children:[t(vn,{}),t("span",{children:"Sort Ascending"})]}),i(M,{$theme:l,onClick:()=>{$e(n,!1),S()},children:[t(Sn,{}),t("span",{children:"Sort Descending"})]})]}),i(se,{$theme:l,children:[i(M,{$theme:l,$hasSubmenu:!0,onClick:()=>{},children:[t(hi,{}),t("span",{children:"Pin Column"})]}),i(M,{$theme:l,onClick:()=>{W(n,"left"),S()},style:{paddingLeft:36},children:[t(ui,{}),t("span",{children:"Pin Left"})]}),i(M,{$theme:l,onClick:()=>{W(n,"right"),S()},style:{paddingLeft:36},children:[t(gi,{}),t("span",{children:"Pin Right"})]}),i(M,{$theme:l,onClick:()=>{W(n,null),S()},style:{paddingLeft:36},children:[t(pi,{}),t("span",{children:"No Pin"})]})]}),i(se,{$theme:l,children:[i(M,{$theme:l,onClick:()=>{S()},children:[t(xn,{}),t("span",{children:"Autosize This Column"})]}),i(M,{$theme:l,onClick:()=>{S()},children:[t(xn,{}),t("span",{children:"Autosize All Columns"})]})]}),e.field&&e.enableRowGroup!==!1&&t(se,{$theme:l,children:i(M,{$theme:l,onClick:()=>{rl(e.field),S()},children:[t(Ae,{}),i("span",{children:["Group by ",e.headerName||e.field]})]})}),i(se,{$theme:l,children:[i(M,{$theme:l,onClick:()=>{Ue(!0),le("columns"),S()},children:[t(Te,{}),t("span",{children:"Choose Columns"})]}),i(M,{$theme:l,onClick:()=>{fe(),S()},children:[t(mi,{}),t("span",{children:"Reset Columns"})]})]})]})},Tl=()=>{if(!G.visible||!G.colId)return null;const e=_.find(a=>a.colId===G.colId);if(!e||!e.field)return null;const n=e.field,r=P(n),o=F[n]||new Set(r),s=o.size===r.length;return i(Er,{$theme:l,style:{position:"fixed",top:G.y,left:G.x,zIndex:1e3},onClick:a=>a.stopPropagation(),children:[t(Tr,{$theme:l,children:"Text Filter"}),t(Ar,{$theme:l,children:t("input",{type:"text",placeholder:"Search...",autoFocus:!0})}),i($n,{$theme:l,children:[i(de,{$theme:l,$selectAll:!0,children:[t("input",{type:"checkbox",checked:s,onChange:()=>et(n)}),"(Select All)"]}),r.map(a=>i(de,{$theme:l,children:[t("input",{type:"checkbox",checked:o.has(a),onChange:()=>Qt(n,a)}),a]},a))]}),i(Br,{$theme:l,children:[t(kn,{$theme:l,onClick:()=>{et(n)},children:"Reset"}),t(kn,{$theme:l,$primary:!0,onClick:()=>{Ye()},children:"Apply"})]})]})},Al=()=>R.sideBar===!1?null:i(kr,{$theme:l,$open:ne,children:[t(vr,{$theme:l,$collapsed:!ne,children:ne?i(ie,{children:[i(Fe,{$theme:l,$active:q==="columns",onClick:()=>le("columns"),children:[t(Te,{}),"Columns"]}),i(Fe,{$theme:l,$active:q==="filters",onClick:()=>le("filters"),children:[t(Ee,{}),"Filters"]})]}):i(ie,{children:[t(Fe,{$theme:l,$collapsed:!0,$active:q==="columns",onClick:()=>{Ue(!0),le("columns")},title:"Columns",children:t(Te,{})}),t(Fe,{$theme:l,$collapsed:!0,$active:q==="filters",onClick:()=>{Ue(!0),le("filters")},title:"Filters",children:t(Ee,{})})]})}),ne&&i(Sr,{$theme:l,children:[q==="columns"&&i(ie,{children:[i(Pr,{$theme:l,children:[t(Rr,{$theme:l,children:"Pivot Mode"}),i(Dr,{$theme:l,children:[t("input",{type:"checkbox",checked:ol,onChange:al}),t("span",{})]})]}),t(mn,{$theme:l,children:t("input",{type:"text",placeholder:"Search..."})}),i(it,{$theme:l,children:[i(ot,{$theme:l,children:[t(Te,{}),"Columns"]}),me.map(e=>{const n=e.colId,r=!e.hide;return i(xr,{$theme:l,$dragging:E===n,$selected:cl===n,draggable:!0,onDragStart:a=>hl(a,n),onDragOver:a=>ul(a,n),onDragLeave:gl,onDrop:a=>pl(a,n),onDragEnd:ml,children:[t(Cn,{$theme:l,children:t(ht,{})}),t(De,{type:"checkbox",$theme:l,checked:r,onChange:a=>{Ce(n,a.target.checked)}}),t(yr,{children:e.headerName||e.field})]},n)})]}),i(it,{$theme:l,children:[i(ot,{$theme:l,children:[t(Ae,{}),"Row Groups"]}),t(at,{$theme:l,$hasItems:Ze.length>0,children:Ze.length===0?i(st,{$theme:l,children:[t(Ae,{}),"Drag here to set row groups"]}):qt.map(({field:e,headerName:n})=>i(fn,{$theme:l,children:[n,t("button",{onClick:()=>Ot(e),children:t(ce,{})})]},e))})]}),i(it,{$theme:l,children:[i(ot,{$theme:l,children:[t(yn,{}),"Values"]}),t(br,{$theme:l,children:Kt.length===0?t(at,{$theme:l,$hasItems:!1,children:i(st,{$theme:l,children:[t(yn,{}),"Drag here to aggregate"]})}):Kt.map(({field:e,aggFunc:n,displayName:r})=>i(wr,{$theme:l,children:[i(Mr,{$theme:l,children:[t(Cn,{$theme:l,children:t(ht,{})}),n,"(",r,")"]}),t(Ir,{$theme:l,onClick:()=>il(e,n),children:t(ce,{})})]},`${n}-${e}`))})]})]}),q==="filters"&&i(ie,{children:[t(mn,{$theme:l,children:t("input",{type:"text",placeholder:"Search..."})}),_.filter(e=>e.filter&&e.field).map(e=>{const n=e.field,r=sl.has(n),o=Gt(n)||Xt(n),s=P(n),a=F[n]||new Set(s);return i(Gr,{$theme:l,children:[i(zr,{$theme:l,$expanded:r,$hasFilter:o,onClick:()=>Cl(n),children:[t(ct,{}),e.headerName||e.field,o&&t(Ee,{})]}),r&&t(Vr,{$theme:l,$expanded:r,children:i($n,{$theme:l,style:{maxHeight:200,marginBottom:8},children:[i(de,{$theme:l,$selectAll:!0,children:[t("input",{type:"checkbox",checked:a.size===s.length,onChange:()=>et(n)}),"(Select All)"]}),s.slice(0,20).map(d=>i(de,{$theme:l,children:[t("input",{type:"checkbox",checked:a.has(d),onChange:()=>Qt(n,d)}),d]},d)),s.length>20&&t(de,{$theme:l,children:i("span",{style:{opacity:.6,fontSize:12},children:["...and ",s.length-20," more"]})})]})})]},e.colId)})]})]})]});return Ie(()=>{const e=()=>{v.visible&&S(),G.visible&&Ye()};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[v.visible,G.visible,S,Ye]),i(Vl,{ref:we,$theme:l,$responsive:yt,style:qn,className:Kn,onKeyDown:xl,tabIndex:0,dir:Nn?"rtl":"ltr",children:[i(Wl,{$theme:l,children:[i(rn,{children:[i(Nl,{$theme:l,children:[t(li,{}),t("input",{type:"text",placeholder:"Search...",value:He,onChange:e=>{Z(e.target.value),Ft?.({type:"filterChanged",api:h,columnApi:u,context:c})}})]}),(We||fl)&&i(ae,{$theme:l,onClick:$l,children:[t(ce,{}),"Clear Filters"]})]}),i(rn,{children:[!Gn&&i(ae,{$theme:l,onClick:()=>dt(y,g,"export.csv"),children:[t(ai,{}),"Export"]}),i(ae,{$theme:l,onClick:fe,children:[t(si,{}),"Reset"]}),R.sideBar!==!1&&t(ae,{$theme:l,$active:ne,onClick:tl,children:t(Ci,{})})]})]}),R.rowGroupPanelShow!=="never"&&Ze.length>0&&i(at,{$theme:l,$hasItems:!0,children:[t(st,{$theme:l,children:t(Ae,{})}),qt.map(({field:e,headerName:n})=>i(fn,{$theme:l,children:[n,t("button",{onClick:()=>Ot(e),children:t(ce,{})})]},e))]}),C.length>0&&i(Cr,{$theme:l,$visible:C.length>0,children:[i("span",{children:[C.length," row",C.length!==1?"s":""," selected"]}),t(fr,{children:i(ae,{$theme:l,style:{background:"transparent",border:"none",color:"white"},onClick:ee,children:[t(ce,{}),"Clear"]})})]}),i(Hr,{children:[i(Wr,{children:[t(Hl,{children:i(jl,{$stickyHeader:!0,$maxHeight:In==="autoHeight"?void 0:"calc(100% - 100px)",children:[yt&&el?m.length===0?nn():Rl():i(ie,{children:[m.length===0&&!Ut&&nn(),m.length>0&&i(Ol,{ref:kl,$theme:l,$fixedLayout:!0,children:[i(ql,{$theme:l,$sticky:!0,children:[bl(),wl(),Ml()]}),t(er,{$theme:l,children:m.map((e,n)=>Pl(e,ve+n))})]})]}),Ut&&Dl()]})}),Ll(),Bn&&i(sr,{$theme:l,children:[i(cn,{children:[t("strong",{children:"Rows:"})," ",y.length]}),i(cn,{children:[t("strong",{children:"Selected:"})," ",C.length]})]})]}),Al()]}),Fl(),El(),Tl()]})}export const AgGrid=Gl(fi);export default AgGrid;
