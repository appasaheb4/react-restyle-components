"use strict";"use client";import{Fragment as b,jsx as d,jsxs as K}from"react/jsx-runtime";import{forwardRef as ye,useState as y,useRef as E,useCallback as C,useEffect as f,useMemo as M}from"react";import{createPortal as Ee}from"react-dom";import{TooltipTrigger as Ce,TooltipContent as Pe,TooltipArrow as Le,TooltipPortal as ke}from"./elements";import{calculateTooltipPosition as Q,getAlternatePosition as xe,clampToViewport as Ae,sideAlignToPosition as Re}from"./utils";export const Tooltip=ye(function(X,m){const{children:O,content:p,position:P,side:L,align:z="center",variant:N="dark",size:Y="medium",delay:I=200,hideDelay:j=0,offset:Z=8,sideOffset:ee,maxWidth:te=280,showArrow:ne=!0,disabled:B=!1,trigger:h=["hover","focus"],open:W,onOpenChange:g,avoidCollisions:q=!0,portal:oe=!0,animated:re=!0,classNames:k={},styles:x={},className:ie,zIndex:se=9999,ariaLabel:ce,...le}=X,c=E(null),l=E(null),i=E(null),s=E(null),[ue,_]=y(!1),[H,ae]=y({top:-9999,left:-9999}),[S,de]=y("top"),[fe,me]=y(!1);f(()=>{me(!0)},[]);const u=W!==void 0,t=u?W:ue,w=M(()=>P||(L?Re(L,z):"top"),[P,L,z]),A=ee??Z,o=M(()=>Array.isArray(h)?h:[h],[h]),R=C(()=>{if(!c.current||!l.current)return;const e=c.current.getBoundingClientRect(),r=l.current.getBoundingClientRect(),U=window.innerWidth,G=window.innerHeight,T={width:r.width,height:r.height};let J=w,a=Q(w,e,T,A);if(q){const $=xe(w,a,T,U,G);$&&(J=$,a=Q($,e,T,A)),a=Ae(a,T,U,G)}de(J),ae(a)},[w,A,q]),v=C(()=>{B||!p||(s.current&&(clearTimeout(s.current),s.current=null),i.current=setTimeout(()=>{u?g?.(!0):_(!0)},I))},[B,p,I,u,g]),n=C(()=>{i.current&&(clearTimeout(i.current),i.current=null),s.current=setTimeout(()=>{u?g?.(!1):_(!1)},j)},[j,u,g]),pe=C(()=>{t?n():v()},[t,v,n]);f(()=>{if(t){requestAnimationFrame(()=>{requestAnimationFrame(()=>{R()})});const e=()=>{requestAnimationFrame(R)};return window.addEventListener("scroll",e,!0),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e,!0),window.removeEventListener("resize",e)}}},[t,R]),f(()=>{if(!t)return;const e=r=>{r.key==="Escape"&&n()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,n]),f(()=>{if(!t||!o.includes("click"))return;const e=r=>{c.current&&!c.current.contains(r.target)&&l.current&&!l.current.contains(r.target)&&n()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[t,o,n]),f(()=>()=>{i.current&&clearTimeout(i.current),s.current&&clearTimeout(s.current)},[]);const he=o.includes("hover")?v:void 0,ge=o.includes("hover")?n:void 0,we=o.includes("focus")?v:void 0,ve=o.includes("focus")?n:void 0,Te=o.includes("click")?pe:void 0;if(!p)return d(b,{children:O});const V=M(()=>`tooltip-${Math.random().toString(36).substr(2,9)}`,[]),D=t&&K(Pe,{ref:l,role:"tooltip",id:V,"aria-label":ce,$variant:N,$size:Y,$maxWidth:te,$animated:re,$isVisible:t,$position:S,className:k.content,style:{top:H.top,left:H.left,...x.content},children:[p,ne&&d(Le,{$variant:N,$position:S,className:k.arrow,style:x.arrow})]});return K(b,{children:[d(Ce,{ref:e=>{c.current=e,typeof m=="function"?m(e):m&&(m.current=e)},className:ie||k.trigger,style:x.trigger,onMouseEnter:he,onMouseLeave:ge,onFocus:we,onBlur:ve,onClick:Te,"aria-describedby":t?V:void 0,"data-state":t?"open":"closed",...le,children:O}),oe&&fe?Ee(d(ke,{$zIndex:se,children:D}),document.body):D]})});Tooltip.displayName="Tooltip";export const TooltipProvider=({children:F})=>d(b,{children:F});
