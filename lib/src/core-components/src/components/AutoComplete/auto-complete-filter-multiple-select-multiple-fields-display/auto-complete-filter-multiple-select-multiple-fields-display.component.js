"use strict";import{jsx as r,jsxs as b,Fragment as J}from"react/jsx-runtime";import{useState as x,useEffect as M,useRef as P}from"react";import{Icon as T}from"../../Icon/Icon";import e from"../../../tc.module.css";import{cn as a}from"../../../utils";import{debounce as W}from"@techabl/core-utils";export const AutoCompleteFilterMultipleSelectMultipleFieldsDisplay=({uniqueField:p="_id",isSelectedStringArray:g=!1,loader:Q=!1,placeholder:_="Search...",data:c,hasError:v=!1,disable:K=!1,isUpperCase:R=!1,name:U,classNames:l={},styles:t={},maxHeight:D="250px",onFilter:m,onUpdate:C,onSelect:N,onBlur:I})=>{const[w,y]=x(""),[d,$]=x(),[A,V]=x(),[f,O]=x(!1),Y=n=>{M(()=>{function o(u){if(n.current&&!n.current.contains(u.target)&&f){if(A&&d&&f){const i=d.filter(s=>s.selected),L=c.selected||[],h=new Map;i.forEach(s=>{h.set(s[p],s)}),L.forEach(s=>{const H=g?s:s[p];d.some(E=>g?E[p]===s:E[p]===s[p])||h.set(H,s)});const j=Array.from(h.values());C&&C(j)}O(!1),y("")}}return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[n,f])},S=P(null);Y(S);let k=0;const z=(n,o)=>(k===0&&(o=o?.filter((i,L)=>(i.selected=!1,n&&n.length>0?n.find((h,j)=>{g?h===i[p]&&(i.selected=!0):h[p]===i[p]&&(i.selected=!0)}):i.selected=!1,k++,i))),o);M(()=>{V(z(c.selected,c.list)),$(z(c.selected,c.list))},[c,c.selected]);const B=n=>{const o=n.target.value;y(o),W(()=>{m&&m(o)})},G=n=>{if((n.which?n.which:n.keyCode)===8){const u=n.target.value;W(()=>{m&&m(u)})}};return r(J,{children:b("div",{ref:S,className:a(e["w-full"],e.relative,l.container),style:t.container,children:[b("div",{className:a(e.flex,e["items-center"],e["leading-4"],e["p-2"],e["focus:outline-none"],e["focus:ring"],e["w-full"],e["shadow-sm"],e["sm:text-base"],e.border,e["rounded-md"],{[e["border-red"]]:v,[e["border-gray-300"]]:!v},l.inputWrapper),style:t.inputWrapper,children:[r("input",{placeholder:_,disabled:K,name:U,value:f?R?w?.toUpperCase():w:c?.selected?.length>0?`${c.selected&&c.selected.length||0} Items`:w,className:a(e["w-full"],e["focus:outline-none"],e["bg-none"],l.input),style:t.input,onKeyUp:G,onChange:B,onClick:()=>O(!0),onBlur:n=>I&&I(n)}),r("span",{className:l?.iconWrapper,style:t?.iconWrapper,children:f?r(T,{nameIcon:"FaChevronUp",propsIcon:{size:t?.iconSize||16,color:t?.iconColor||"#000000"}}):r(T,{nameIcon:"FaChevronDown",propsIcon:{size:t?.iconSize||16,color:t?.iconColor||"#000000"}})})]}),d&&f?d?.length>0?r("div",{className:a(e.flex,e["mt-1"],e.absolute,e["rounded-sm"],e["bg-gray-200"],e["z-500"],e["p-2"],e["w-full"],l.dropdown),style:{zIndex:80,maxHeight:D,overflowY:"auto",...t.dropdown},children:r("ul",{className:l.list,style:t.list,children:d?.map((n,o)=>r("li",{className:a(e.flex,e["gap-2"],e["p-1"],l.listItem),style:t.listItem,children:b("label",{className:a(e.flex,e["items-center"],l.label),style:t.label,children:[r("input",{id:o?.toString(),className:a(e.flex,e["h-4"],e["w-4"],l.checkbox),style:t.checkbox,type:"checkbox",checked:n.selected,onChange:()=>N(n)})," ",r("span",{className:a(e.flex,e["ml-2"],l.itemText),style:t.itemText,children:c.displayKey.map(u=>`${n[u]}
                              `).join(" - ")})]})},o))})}):r("div",{className:a(e["mt-1"],e.absolute,e["bg-gray-200"],e["p-2"],e["rounded-sm"],l.emptyState),style:{zIndex:80,width:"100%",...t.emptyState},children:r("span",{className:l.emptyStateText,style:t.emptyStateText,children:"Not Found Result!!"})}):null]})})};
