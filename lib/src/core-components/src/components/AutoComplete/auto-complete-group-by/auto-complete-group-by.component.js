"use strict";import{jsx as s,jsxs as v,Fragment as I}from"react/jsx-runtime";import{useState as C,useEffect as y,useRef as j}from"react";import{Icon as L}from"../../Icon/Icon";import e from"../../../tc.module.css";import{cn as i}from"../../../utils";export const AutocompleteGroupBy=({data:h=[],hasError:b=!1,displayValue:p="",onChange:f,onClose:z})=>{const[a,c]=C(p),[d,w]=C(),[u,m]=C(!1),k=l=>{y(()=>{function n(t){l.current&&!l.current.contains(t.target)&&u&&(m(!1),c(""))}return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[l,u])},N=j(null);k(N),y(()=>{c(p)},[p]),y(()=>{w(h||[])},[h]);const F=(l,n)=>{const t=new Set;return l.filter(r=>{const o=n(r);return t.has(o)?!1:t.add(o)})},O=(l,n)=>{if(l!==""){let t=[];n.filter(r=>{r.children.filter(o=>{o.title&&o.title.toLowerCase().indexOf(l.toLowerCase())>-1&&(t.filter((g,x)=>{if(g.name===r.name){const S=t[x].children.concat(o);t[x]={...t[x],children:S}}}).length<1&&t.push({...r,children:[o]}),t=F(t,g=>g.name))})}),w(t)}else w(n)},A=l=>{const n=l.target.value;c(n),O(n,h)};return s(I,{children:v("div",{ref:N,className:i(e["w-full"],e.relative),children:[v("div",{className:i(e.flex,e["items-center"],e["leading-4"],e["p-2"],e["bg-white"],e["focus:outline-none"],e["focus:ring"],e["w-full"],e["shadow-sm"],e["sm:text-base"],e.border,e["rounded-md"],{[e["border-red"]]:b,[e["border-gray-300"]]:!b}),children:[s("input",{placeholder:"Search...",value:a,className:i(e["w-full"],e["focus:outline-none"]),onChange:A,onClick:()=>m(!0),onKeyDown:l=>{if(l.key==="Enter"){l.preventDefault();let n=null,t=null;for(const r of d){for(const o of r.children)if(o.title.toLowerCase()===a.toLowerCase()||r.title.toLowerCase()===a.toLowerCase()){n=r,t=o;break}if(n)break}f&&n&&t&&f(n,t),m(!1),c(a)}}}),u?s(L,{nameIcon:"FaChevronUp",propsIcon:{size:16}}):s(L,{nameIcon:"FaChevronDown",propsIcon:{size:16}})]}),d&&u?d?.length>0?s("div",{className:i(e.flex,e["mt-1"],e.absolute,e["z-50"],e["rounded-md"],e["bg-gray-200"],e["w-100"],e["w-full"]),children:s("ul",{className:i(e.flex,e["p-2"],e["rounded-sm"],e["w-full"]),children:s("div",{className:i(e.flex,e["flex-col"],e["w-full"]),style:{height:"auto",maxHeight:"350px"},children:d?.map((l,n)=>v(I,{children:[s("li",{className:i(e.flex+" "+e["text-gray-400"]),children:l.title},n),s("ul",{className:i(e.flex,e["flex-col"],e["ml-4"],e["w-full"]),children:l?.children?.map((t,r)=>s("li",{className:i(e.flex,e["hover:bg-gray-200"],e["focus:outline-none"],e["cursor-pointer"],e["w-full"]),onClick:async()=>{f&&f(l,t),m(!1),c(t.title)},children:t.title},r))})]}))})})}):s("div",{className:i(e["mt-1"],e.absolute,e["bg-gray-200"],e["p-2"],e["rounded-md"]),style:{zIndex:80,width:"100%"},children:s("span",{children:"Not Found Result!!"})}):null]})})};
